# docs

You can generate the documentation for the CRD with the following command: `./make.sh ${DEST_DIR} ${K8S_VERSION}`

## How it works

This process uses [crd-ref-docs](https://github.com/elastic/crd-ref-docs) to generate a [Markdown file](./docs.md) from the [CRD schema](../../api/v1).
The Markdown is then converted to HTML using [pandoc](https://github.com/jgm/pandoc).

The visual style is based on a publicly available CSS that has been [customized](./docs.css) for this project.

## Viewing locally

A self-contained `index.html` file will be created in the `$DEST_DIR` directory. To view the documentation, simply open this file in your web browser.

## Updating manifest examples

The resources located in [examples/results](./examples/results) are generated by the controller from the contents of [`config/samples`](../../config/samples). These example manifests must be updated manually.

To do this, run the following commands from the project's root directory:

```shell
# PWD=project_root
make deploy-local
make sample
```

After the sample resources are created, retrieve the YAML for the generated resource using `kubectl`.
Then, commit the resulting YAML file to the [examples/results](./examples/results) directory.

For example: `kubectl get job <GENERATED_JOB_NAME> -o yaml`

The "Examples" section of the final documentation is generated by the [examples/generate.sh](./examples/generate.sh) script.

## Updating kustomize configurations

To update the [transformer configurations](https://github.com/kubernetes-sigs/kustomize/tree/master/examples/transformerconfigs), edit [`transform.yaml`](./kustomize/transform.yaml).
