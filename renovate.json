{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "baseBranches": ["main"],
  "assignees": ["lyluck-pixiv"],
  "extends": [
    "config:recommended",
    ":label(renovate)",
    ":timezone(Asia/Tokyo)",
    ":prHourlyLimitNone",
    ":prConcurrentLimitNone",
    ":rebaseStalePrs",
    ":disableDependencyDashboard",
    "helpers:pinGitHubActionDigests",
    "schedule:monthly"
  ],
  "platformAutomerge": true,
  "fetchChangeLogs": "off",
  "rangeStrategy": "auto",
  "minimumReleaseAge": "7 days",
  "internalChecksFilter": "strict",
  "postUpdateOptions": ["gomodTidy"],
  "ignorePaths": ["config/manager/*"],
  "digest": {
    "addLabels": ["digest"]
  },
  "pin": {
    "addLabels": ["pin"]
  },
  "patch": {
    "addLabels": ["patch"]
  },
  "minor": {
    "addLabels": ["minor"]
  },
  "major": {
    "addLabels": ["major"]
  },
  "packageRules": [
    {
      "description": "Group github-actions dependencies",
      "groupName": "github-actions({{packageName}})",
      "addLabels": ["github-actions"],
      "matchManagers": ["github-actions"]
    },
    {
      "description": "Group docker dependencies",
      "groupName": "docker({{updateType}}): {{depName}}",
      "addLabels": ["docker"],
      "matchDatasources": ["docker"],
      "matchDepNames": [
        "*",
        "!golang"
      ]
    },
    {
      "description": "Group go dependencies",
      "groupName": "go({{updateType}}) in {{#if packageFileDir}}{{packageFileDir}}{{else}}root{{/if}}",
      "addLabels": ["go"],
      "matchDatasources": ["go"],
      "matchDepNames": [
        "*",
        "!go"
      ]
    },
    {
      "description": "Group golang version",
      "groupName": "go-version",
      "addLabels": ["go-version"],
      "matchDepNames": ["go", "golang"],
      "matchDatasources": ["go", "docker"]
    }
  ],
  "customManagers":[
    {
      "description": "Manage go version",
      "customType": "regex",
      "fileMatch": ["^.github/.env$"],
      "matchStrings": ["GO_VERSION=(?<currentValue>\\d+\\.\\d+)"],
      "datasourceTemplate": "golang-version",
      "depNameTemplate": "go",
      "versioningTemplate": "go-mod"
    },
    {
      "description": "Manage helm version",
      "customType": "regex",
      "fileMatch": ["^.github/.env$"],
      "matchStrings":["HELM_VERSION=(?<currentValue>v\\d+\\.\\d+\\.\\d)"],
      "datasourceTemplate": "github-tags",
      "depNameTemplate": "helm/helm"
    },
    {
      "description": "Manage kubectl version",
      "customType": "regex",
      "fileMatch": ["^.github/.env$"],
      "matchStrings":["KUBECTL_VERSION=(?<currentValue>v\\d+\\.\\d+\\.\\d)"],
      "datasourceTemplate": "github-tags",
      "depNameTemplate": "kubernetes/kubernetes"
    },
    {
      "description": "Manage kind node version",
      "customType": "regex",
      "fileMatch": ["^.github/.env$"],
      "matchStrings":["KIND_NODE_IMAGE=kindest/node:(?<currentValue>v\\d+\\.\\d+\\.\\d)"],
      "datasourceTemplate": "docker",
      "depNameTemplate": "kindest/node"
    },
    {
      "description": "Manage pandoc version",
      "customType": "regex",
      "fileMatch": ["^.github/.env$"],
      "matchStrings":["PANCOD_VERSION=(?<currentValue>\\d+\\.\\d+\\.\\d)"],
      "datasourceTemplate": "github-tags",
      "depNameTemplate": "jgm/pandoc"
    }
  ]
}
